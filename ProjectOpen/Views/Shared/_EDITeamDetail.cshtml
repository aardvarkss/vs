@model ProjectOpen.Models.ViewModel.TeamSummary

@helper DisplayPrice(string inp)
{
    try
    {
        Decimal a = Decimal.Parse(inp);
        @String.Format("{0:C2}", a);
    }
    catch(Exception ex)
    {
        <span></span>
    }
}

@helper DisplayNumber(string inp)
{
    try
    {
        Decimal a = Decimal.Parse(inp);
        @String.Format("{0:0.#}", a);
    }
    catch(Exception ex)
    {
<span></span>
    }
}

@helper DisplayDate(string inp)
{
    try
    {
        DateTime a = DateTime.Parse(inp);
        @a.ToString("d");
    }
    catch (Exception ex)
    {
        <span></span>
    }
}

<div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">
            <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#">
                Rejection List - @Model.Data.Tables[0].Rows[0]["team_name"]
            </a>
        </h3>
    </div>

    <div id="#1" class="panel-collapse">
        <div class="panel-body">
            <table class="table table-hover table-bordered">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Created</th>
                        <th>Account</th>
                        <th>Order Reference</th>
                        <th>Message</th>
                        <th>Line</th>
                        <th>Order</th>
                        <th>Product</th>
                        <th>Qty</th>
                        <th>Price</th>
                        <th class="align-center">Details</th>
                    </tr>
                </thead>
                <tbody>

                    @{
                        int count = 1;
                    }

                    @foreach (System.Data.DataRow p in Model.Data.Tables[0].Rows)
                    {
                        <tr>
                            <td>@count</td>
                            <td>@DisplayDate(p[29].ToString()) @p[30]</td>
                            <td>@p[4]</td>
                            <td>@p[5]</td>
                            <td>@p[6]</td>
                            <td>@p[17]</td>
                            <td>@p[15]</td> 
                            <td>@p[18]</td>
                            <td>@DisplayNumber(p[19].ToString())</td>
                            <td>@DisplayPrice(p[20].ToString())</td>
                            
                            <td class="align-center"><a href="/Home/Rejection/@p[2]" target="_blank"><span class="icol-clipboard-text">&nbsp;</span></a></td>
                        </tr>

                        count++;
                    }
                </tbody>
            </table>
        </div>
    </div> <!-- /.widget-content -->
</div> <!-- /.widget .box -->

